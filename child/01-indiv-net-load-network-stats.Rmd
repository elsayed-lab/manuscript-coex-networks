```{r remove_uneeded_params}
# remove any static parameters
df <- df[,apply(df, 2, function(x) { length(unique(x)) > 1 })]
```

```{r compute_scores}
# IRefIndex score <- ratio of supported weights * 1000
if ('ireg_score' %in% colnames(df)) {
    df$iref_score <- (df$irefindex_edge_weight / df$total_edge_weight) * 1000
}

# Enrichment (total and unique annotations)
if ('marbach_total_enriched' %in% colnames(df)) {
    # Human
    df$total_enriched        <- df$go_total_enriched + df$cpdb_total_enriched + df$marbach_total_enriched
    df$total_enriched_unique <- df$unique_go_terms + df$unique_cpdb_terms + df$unique_marbach_terms

    df$enrichment_score       <- as.vector(1/3 * (scale(df$unique_go_terms) +
                                                  scale(df$unique_cpdb_terms) + 
                                                  scale(df$unique_marbach_terms)))
    df$enrichment_score_total <- as.vector(1/3 * (scale(df$go_total_enriched) +
                                                  scale(df$cpdb_total_enriched) + 
                                                  scale(df$marbach_total_enriched)))
} else if ('cpdb_total_enriched' %in% colnames(df)) {
    # Mouse
    df$total_enriched        <- df$go_total_enriched + df$cpdb_total_enriched
    df$total_enriched_unique <- df$unique_go_terms + df$unique_cpdb_terms

    df$enrichment_score       <- as.vector(1/2 * (scale(df$unique_go_terms) +
                                                  scale(df$unique_cpdb_terms)))
    df$enrichment_score_total <- as.vector(1/2 * (scale(df$go_total_enriched) +
                                                  scale(df$cpdb_total_enriched)))
} else {
    # All other organisms
    df$total_enriched         <- df$go_total_enriched
    df$total_enriched_unique  <- df$unique_go_terms

    df$enrichment_score       <- as.vector(scale(df$unique_go_terms))
    df$enrichment_score_total <- as.vector(scale(df$go_total_enriched))
}

# sort by enrichment score and add a rank column
df <- df %>% 
    arrange(desc(enrichment_score)) %>%
    mutate(rank=1:nrow(df)) %>%
    rename(network_id=id)

# show rank column at left
df <- df[,c(ncol(df), 1:(ncol(df) - 1))]

```

```{r indiv_nets_summary}
datatable(df %>% arrange(desc(enrichment_score)))
```
